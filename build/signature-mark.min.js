/*! signature-mark.js - 0.0.1 - 2013-05-21 - scottmotte */
(function(t){var e=function(t){return this instanceof e?(this.canvas=t,this.init(),this):new e(t)};e.prototype.init=function(){this.initVariables(),this.initPainters(),this.initEvents()},t.SignatureMark=e})(this),function(t){t.prototype.initEvents=function(){var t=this;t.canvas.addEventListener(t.mouse_down,function(e){t.onCanvasMouseDown(t,e)},!1),t.canvas.addEventListener(t.mouse_move,function(e){t.onCanvasMouseMove(t,e)},!1),t.canvas.addEventListener("contextmenu",function(e){t.preventRightClick(t,e)},!1),document.addEventListener(t.mouse_up,function(e){t.onCanvasMouseUp(t,e)},!1),t.canvas.addEventListener(t.mouse_up,function(e){t.onCanvasMouseUp(t,e)},!1)},t.prototype.preventRightClick=function(t,e){e.preventDefault()},t.prototype.onCanvasMouseDown=function(t,e){e.preventDefault(),t.setCanvasOffset(t),t.startDrawingStroke(t),t.setMouseXAndMouseY(t,e),t.setPainters(t)},t.prototype.onCanvasMouseMove=function(t,e){e.preventDefault(),t.setMouseXAndMouseY(t,e)},t.prototype.onCanvasMouseUp=function(t){t.stopDrawingStroke(t)},t.prototype.setMouseXAndMouseY=function(t,e){t.touch_supported?(target=e.touches[0],t.mouseX=target.pageX-t.canvasOffsetLeft,t.mouseY=target.pageY-t.canvasOffsetTop):(t.mouseX=e.pageX-t.canvasOffsetLeft,t.mouseY=e.pageY-t.canvasOffsetTop)},t.prototype.setCanvasOffset=function(t){canvasOffset=t.Offset(t.canvas),t.canvasOffsetLeft=canvasOffset.left,t.canvasOffsetTop=canvasOffset.top}}(SignatureMark),function(t){t.prototype.Offset=function(t){if(void 0===t)return null;var e=t.getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset}}}(SignatureMark),function(t){t.prototype.initPainters=function(){this.painters=[];for(var t=0;this.max_strokes>t;t++){var e=.05*Math.random()+this.easing;this.painters.push({dx:0,dy:0,ax:0,ay:0,div:.1,ease:e})}},t.prototype.setPainters=function(t){for(var e=0;t.painters.length>e;e++)pntr=t.painters[e],pntr.dx=t.mouseX,pntr.dy=t.mouseY}}(SignatureMark),function(t){t.prototype.drawStroke=function(t){var e;for(e=0;t.painters.length>e;e++){t.context.beginPath(),pntr=t.painters[e],t.context.moveTo(pntr.dx,pntr.dy);var n=pntr.ax=(pntr.ax+(pntr.dx-t.mouseX)*pntr.div)*pntr.ease;pntr.dx-=n;var o=pntr.dx,s=pntr.ay=(pntr.ay+(pntr.dy-t.mouseY)*pntr.div)*pntr.ease;pntr.dy-=s;var r=pntr.dy;t.context.lineTo(o,r),t.context.stroke()}},t.prototype.startDrawingStroke=function(t){var e=setInterval(function(){t.drawStroke(t)},t.refresh_rate);t.strokeIntervals.push(e)},t.prototype.stopDrawingStroke=function(t){for(var e=0;t.strokeIntervals.length>e;e++)clearInterval(t.strokeIntervals[e])}}(SignatureMark),function(t){t.prototype.initVariables=function(){this.touch_supported="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?!0:!1,this.context=this.canvas.getContext("2d"),this.color=[0,0,0],this.brush_pressure=.5,this.context.strokeStyle="rgba("+this.color[0]+", "+this.color[1]+", "+this.color[2]+", "+this.brush_pressure+")",this.context.lineWidth=2.5,this.painters=[],this.mouseX=0,this.mouseY=0,this.strokeIntervals=[],this.refresh_rate=5,this.max_strokes=12,this.easing=.7,this.mouse_down="mousedown",this.mouse_move="mousemove",this.mouse_up="mouseup",this.touch_supported?(this.mouse_down="touchstart",this.mouse_move="touchmove",this.mouse_up="touchend"):(this.refresh_rate=10,this.max_strokes=100)}}(SignatureMark);